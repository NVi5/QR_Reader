/*
 * Empty C++ Application
 */
#include "xaxidma.h"
#include "xparameters.h"
#include "xil_exception.h"

#define TEXT_BASE				XPAR_TEXTBLOCK_0_S00_AXI_BASEADDR
#define TEXT_XPOS				(*(uint32_t*)(TEXT_BASE + 0))
#define TEXT_YPOS				(*(uint32_t*)(TEXT_BASE + 4))
#define TEXT_COLOR				(*(uint32_t*)(TEXT_BASE + 8))
#define TEXT_SCALE				(*(uint32_t*)(TEXT_BASE + 12))

__attribute__((section(".vga_text")))
static char text[16*16];

static XAxiDma text_dma;
static XAxiDma_Config *text_dma_config;

int main()
{

	text_dma_config = XAxiDma_LookupConfig(XPAR_AXIDMA_2_DEVICE_ID);
	XAxiDma_CfgInitialize(&text_dma, text_dma_config);

	XAxiDma_SimpleTransfer(
			&text_dma,
			(UINTPTR)text,
			16*16,
			XAXIDMA_DMA_TO_DEVICE
		);
	VGA_TEXT_XPOS = GameInstance->GetXPos();
	VGA_TEXT_YPOS = GameInstance->GetYPos();
	VGA_TEXT_COLOR = GameInstance->GetColor();
	VGA_TEXT_SCALE = GameInstance->GetScale();
	return 0;
}
